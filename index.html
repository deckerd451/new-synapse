<script>
  // Only report errors locally (disabled on GitHub Pages)
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
    window.addEventListener("error", (event) => {
      const isOurAppError =
        event.filename && event.filename.startsWith(window.location.origin);
      if (isOurAppError) {
        try {
          navigator.sendBeacon("/api/client-errors", JSON.stringify({
            message: event.message,
            url: window.location.href,
            userAgent: navigator.userAgent,
            source: event.filename,
            lineno: event.lineno,
            colno: event.colno,
            stack: event.error ? event.error.stack : null,
            timestamp: new Date().toISOString(),
          }));
        } catch (err) {
          console.warn("Error reporter skipped (local only).");
        }
      }
    }, true);
  }
</script>
